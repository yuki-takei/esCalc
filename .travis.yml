language: node_js
node_js:
- '4'
env:
  global:
    # generated by `travis encrypt -r yuki-takei/esCalc 'JSPM_GITHUB_AUTH_TOKEN={...}'`
    # see https://gist.github.com/topheman/25241e48a1b4f91ec6d4
    secure: AthLCR7xW58oDMVYv4MhHyiFG0WACxSeT3eTgp4v7ipBjixDPayQOIDxqTazsyzvbKA1PPoqFmTVIS+t00gWSVGZE+oLgHbRr/+wLhDdXtd1ENZSKaMukOrJN7u5dgtaPM4NrGtB8EoWgDlrJeoSaO03AUt2Hcp/DXkBfagdYE5PoZWS6qJL0UNTZoe6PgBkyraJYkSah8igV9y7k5tqGhejuYOriafyqknmEOXOYcMAzor2e8IMSVK458S8UI5VSpcGVjVGT9IUbiXReP7E506gB+gfBBaKpcnN/c3/2Zrt5Jam+yA0/jQFLfDe+13/U4Ut9DBzwKjuC1kAePWWMJjqhwhUvJSN/q79aYQDtZaPhGPE8XhwZ6Del4mHblWgHYdXqgbweHTUQVhkcOLzq58X51k0dNt2hduEvdLxFtp8dCs+G+4sdktusFOlssigZ3Ookk3IyTDzPpFNigQm7Z8QzK3bcppHJSnIX+PmP7FU/HJIxYc6Rfn5tQ2/nyKAAtba80hdemLyc7dVIl8sQdOu48jVam6KE0S8PKVAjNtbwqnHdyagEB5YEWnAwp0c7NMfU/t+NNqNjpFIWsIPEv+WN/pmw8+EOPEiUO9E8U2vfdEcZ5kKEuP6wWzAITT7DXxykU5upen3wSyM4HDo6zejf5e3d1ssVBRo3ynuJfM=
before_script:
- npm install -g gulp jspm dtsm mocha
- jspm config registries.github.auth $JSPM_GITHUB_AUTH_TOKEN
- jspm install
- dtsm install
script:
- mocha --compilers ts:espower-typescript/guess test/**/*.ts
- gulp package
before_deploy:
- pushd release
- pushd darwin; zip -q ../esCalc-osx-x64.zip -r esCalc-darwin-x64; popd
- pushd win32; zip -q ../esCalc-win32-x64.zip -r esCalc-win32-x64; popd
- pushd linux; tar -jcf ../esCalc-linux-x64.tar.bz2 esCalc-linux-x64; popd
- popd
deploy:
  provider: releases
  api_key:
    # generated by `travis encrypt -r yuki-takei/esCalc '{GITHUB_OAUTH_TOKEN}'`
    secure: e3DfuxSJya21isIUnFT7eoyHRV6ZKOX7lRIuiPI5jAcSb6q3j6nM/TbTycj9IMhGpn0Tp1YMlDAoHplwN8VxtO8D6pRLBT/ct/OEQUj+nWSBjVZ+i94oLW+A/9HbZZGaEuiAWIizW2JVACb7Ebvl2/rFCOlcF7BkJzKu5coaCFszZnKOqHM+TaniImdJz0DiI0eya8Egkd27lpUpfMFHKA0Ppwtt0p0FryIrCJ33qVdxeXLkGHkwohH8Rl2QlyDK2qfk2+qjPQUzC418+MKxOZrQHgw2M9SAdQ96pqOWJEDZ7jgAmgoMpsX8szRUOXn5MauIFyDkwEImmxZh3P3n4WVngMdw6GBQpLfbMO9BwQoMNoUec9XrTFucBEQCZQeMK6ftuVONYGMoand9BZ9OJBDr+4o7cSh549gqwrxHKU0wNmaaAz1+6hqmUicdHpD575ZjNP1WTmUaha+1xeB5FVFylherSgSP1ySWKEUVqizNH7XeLexglYc1A0I6FGCsaU+4xTKYsOzqe22TgdtORHrlt3gXrLgYv+C2vMwj+3tQc2V5K/absgBSQRvyl54gxkjiY3WQTMDPQLYHUWTmMa7RlxoajrnrA5cGwKonRxfMcsCtqYYZyBtT9gTgAtQU9uMEK0pfLD6Yut4cwwOHvtPK8/w/0/t5lNKGn7dqvrQ=
  file:
  - release/esCalc-osx-x64.zip
  - release/esCalc-win32-x64.zip
  - release/esCalc-linux-x64.tar.bz2
  on:
    repo: yuki-takei/esCalc
    tags: true
  skip_cleanup: true
cache:
  directories:
  - node_modules
  - src/jspm_packages
  - ".typings"
